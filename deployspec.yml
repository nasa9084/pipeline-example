version: 0.2

phases:
  pre_build:
    commands:
      - echo install kubectl...
      - curl -LO https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl
      - chmod +x ./kubectl
      - mkdir .kube
      - curl -LO https://s3-us-west-2.amazonaws.com/kube-config-template/kubeconfig-template -o .kube/config
  build:
    commands:
      - echo Deploy application...
      - ./kubectl apply -f https://raw.githubusercontent.com/nasa9084/pipeline-example/master/deploy/deployment.yml
      - ./kubectl apply -f https://raw.githubusercontent.com/nasa9084/pipeline-example/master/deploy/service.yml
